import{c as E,j as e,r as s}from"./client-ZKQMN23D.js";import{a as N}from"./axios-DPCeRp2O.js";import{c as w}from"./index-BNn9J7AE.js";import{d as k}from"./dayjs.min-BIwLhz4I.js";import{u as A}from"./utc-BUuWioZ3.js";import{Themed as D}from"./Themed-BLSBJrUL.js";import{Map as F}from"./Map-DvOZUeFH.js";import{SidebarItems as G}from"./SidebarItems-DJQK6-cV.js";import{G as R}from"./GlobalStyles-BW4QefxH.js";import"./_commonjsHelpers-BosuxZz1.js";import"./global-Cavf3q2D.js";import"./index-BDIa4gQt.js";import"./identifier-DHETMsl0.js";import"./ThemeProvider-BQTsL86O.js";import"./useThemeWithoutDefault-BU2aPzft.js";import"./index-BMQyuaGg.js";import"./Grow--1bk2Oiz.js";import"./useSlotProps-O828vP2f.js";import"./extendSxProp-2i1zAAUV.js";import"./useTheme-CLvhDb73.js";import"./ua-parser-BZV2fO3c.js";import"./index-D3ylJrlI.js";import"./useMediaQuery--fqye5PE.js";import"./getThemeProps-BL5VHue0.js";import"./Tooltip-CvPWsRqB.js";import"./Popper-1aVe17Xg.js";k.extend(A);const T=({collection_id:o=0,lang:i,translations:c,title:x,blurb:C,baseColor:d,cutoffs:a})=>{const[S,f]=s.useState({}),[b,n]=s.useState(),[v,h]=s.useState(!1),m=w.hex.hsl(d||"#cf2029")[0],u={"--theme-color-gradient-1":`hsl(${m} 87.5% 62.35%)`,"--theme-color-gradient-2":`hsl(${m} 67.71% 56.27%)`,"--theme-color-gradient-3":`hsl(${m} 53.36% 50.39%)`,"--theme-color-gradient-4":`hsl(${m} 52.42% 44.51%)`,"--theme-color-gradient-5":`hsl(${m} 52.53% 38.82%)`},l=s.useMemo(()=>({parent_collection:o}),[o]);s.useEffect(()=>{if(!l.parent_collection)return;const t=new AbortController;return N.get("/api/map/items_count",{params:{filter:l,lang:i},signal:t.signal}).then(p=>{if(p.data){const g={};Object.entries(p.data).forEach(([M,r])=>{let j=1;if(a!=null&&a.length&&r.items_count){const _=[...a,Number.MAX_SAFE_INTEGER];_.sort(),j=((_.findIndex(y=>r.items_count<=y)||0)+1)/_.length}g[M]={...r,className:r.items_count?"activity_base":"activity_none",opacity:j,annotationLabel:r.items_count?`${r.items_count} ${r.items_count===1?c.article:c.articles}`:""}}),f(g)}}).catch(p=>{console.warn("load mapdata",p)}),()=>t.abort()},[l,i,c,a]);const $=s.useCallback(t=>{t||n(void 0),h(!!t)},[]),I=s.useCallback(t=>{t!=null&&t.items_count?n(t):n(void 0)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(R,{styles:{[`.map_${o}`]:{"--theme-color-base":d,"--theme-color-light":u["--theme-color-gradient-1"],"--theme-color-dark":u["--theme-color-gradient-5"],...u},[`.map_${o} .activity_base`]:{fill:d}}}),e.jsxs("div",{className:`map_container map_${o}`,children:[e.jsx(F,{mapData:S,onSelectCountry:I}),e.jsx("button",{className:"map_sidebar_opener",onClick:()=>{h(!0),n(void 0)},children:"?"}),e.jsxs("div",{className:`map_sidebar ${v?"active":""}`,children:[e.jsx("button",{className:`map_sidebar_closer ${b?"close_country":"close_intro"}`,onClick:()=>{h(!1),n(void 0)},children:"тип"}),e.jsx(G,{initialContent:e.jsxs(e.Fragment,{children:[x&&e.jsx("h3",{children:x}),C&&e.jsx("div",{dangerouslySetInnerHTML:{__html:C}})]}),selectedCountry:b,filter:l,onChangeItemCount:$,lang:i})]})]})]})},H=(o,i)=>{E(o).render(e.jsx(D,{children:e.jsx(T,{...i})}))};window.renderCollectionItemCountMap=H;
