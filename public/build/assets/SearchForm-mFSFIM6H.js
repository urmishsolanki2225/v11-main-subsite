import{c as b,j as r,r as w}from"./client-ZKQMN23D.js";import{q as _}from"./index-edoyAQHv.js";import{l as F}from"./index.m-DI45-rQC.js";import{Themed as A}from"./Themed-BLSBJrUL.js";import{B as j}from"./Box-CVOB97vC.js";import{B as v}from"./Button-Bs2LlykX.js";import{c as $,A as B}from"./Autocomplete-Byzw-jYA.js";import{T as g}from"./TextField-CXY6ukfK.js";import"./_commonjsHelpers-BosuxZz1.js";import"./identifier-DHETMsl0.js";import"./ThemeProvider-BQTsL86O.js";import"./useThemeWithoutDefault-BU2aPzft.js";import"./index-BMQyuaGg.js";import"./extendSxProp-2i1zAAUV.js";import"./useTheme-CLvhDb73.js";import"./useSlotProps-O828vP2f.js";import"./ButtonBase-B4crtf6-.js";import"./Grow--1bk2Oiz.js";import"./Menu-BfV33fk6.js";import"./useFormControl-CO6OogGI.js";import"./GlobalStyles-BW4QefxH.js";import"./List-BgSNNkKU.js";import"./Select-DstqRMzc.js";import"./FormLabel-BgEYUhxt.js";import"./Close-mNv2SlFn.js";import"./Popper-1aVe17Xg.js";import"./usePreviousProps-eB1Ppz6I.js";const C=({filter:{name:i,options:c,label:f,group_by:m},values:l,onChangeFilter:h})=>{const u=w.useMemo(()=>$(m?{stringify:s=>`${s.label} ${s[m]}`}:{}),[m]);return r.jsx(B,{multiple:!0,value:l,onChange:(s,x)=>h(i,x),options:c,groupBy:m?s=>s[m]:void 0,renderInput:s=>r.jsx(g,{...s,fullWidth:!0,label:f}),ChipProps:{size:"small"},filterOptions:u,disableClearable:l.length<=1},i)},P=({filters:i,translations:c})=>{const[f,m]=w.useState(()=>{var t;const e=_.parse(window.location.search,{ignoreQueryPrefix:!0});if(e!=null&&e.filter&&typeof e.filter=="object"){for(const o in e.filter)if(e.filter[o]&&((t=i.find(n=>n.name===o||n.submit_as===o))!=null&&t.advanced))return!0}return!1}),[l,h]=w.useState(()=>{const e=_.parse(window.location.search,{ignoreQueryPrefix:!0}),t={};if(e!=null&&e.filter&&typeof e.filter=="object"){for(const o in e.filter){if(!e.filter[o])continue;const n=e.filter[o].split(",");for(const p of n){const a=i.find(d=>d.name===o||d.submit_as===o&&d.options.find(S=>`${S.id}`==`${p}`));a&&(t[a.name]||(t[a.name]=[]),t[a.name].push(a.options.find(d=>`${d.id}`==`${p}`)))}}return t}return{}}),u=(e,t)=>{h(o=>({...o,[e]:t}))},s=()=>{var t;const e={filter:{}};for(const o in l){const n=l[o].map(({id:a})=>a).join(","),p=(t=i.find(a=>a.name===o))==null?void 0:t.submit_as;p&&n?e.filter[p]=e.filter[p]?e.filter[p]+","+n:n:n&&(e.filter[o]=n)}window.location.href=F("coop_projects.index",e)},x=()=>{window.location.href=F("coop_projects.index")};return r.jsxs(A,{children:[r.jsx(j,{className:"dev_coop_filter_form_basic",children:i.filter(({advanced:e})=>!e).map(e=>r.jsx(C,{filter:e,values:l[e.name]||[],onChangeFilter:u},e.name))}),r.jsx(j,{className:`dev_coop_filter_form_advanced ${f?"show_advanced":""}`,children:i.filter(({advanced:e})=>e).map(e=>r.jsx(C,{filter:e,values:l[e.name]||[],onChangeFilter:u},e.name))}),r.jsxs(j,{className:"dev_coop_filter_form_buttons",children:[r.jsx(v,{variant:"contained",onClick:()=>s(),children:c.Search}),r.jsx(v,{variant:"text",onClick:()=>m(e=>!e),children:f?c["Hide advanced filters"]:c["Show advanced filters"]}),r.jsx(v,{variant:"text",onClick:()=>x(),children:c["Show all projects"]})]})]})},k=(i,c)=>{const f=document.getElementById("form_root");b(f).render(r.jsx(P,{filters:i,translations:c}))};window.setupForm=k;export{k as setupForm};
