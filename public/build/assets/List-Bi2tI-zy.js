import{j as e,r as s,R as W}from"./client-ZKQMN23D.js";import{d as l,I as R}from"./index-Cvft0mqj.js";import{d as U}from"./Add-CSI57y4_.js";import{l as a}from"./index.m-DI45-rQC.js";import{L as z}from"./Listing-BOo8Gk8o.js";import"./dayjs.min-BIwLhz4I.js";import{u as H}from"./useDataSource-CV27kxAN.js";import{A as O,S as $}from"./AppBarHeader-Bu_GnhUD.js";import{C as V}from"./ContentScroll-BWeVEx1a.js";import{f as Y}from"./Content-CSTk_AN3.js";import{L as G,m as E}from"./DataGridUtils-DqQ54bwL.js";import{i as J}from"./identifier-DHETMsl0.js";import{r as K}from"./Typography-BOH_kjYl.js";import{d as Q}from"./Close-C7klk6A2.js";import{u as X}from"./Grow--1bk2Oiz.js";import{D as Z}from"./Dialog-CPjb0mTO.js";import{I as D}from"./List-BgSNNkKU.js";import{B as F}from"./Box-CVOB97vC.js";import{T as ee}from"./Tooltip-CvPWsRqB.js";import{d as te}from"./Visibility-B51ccO7E.js";import{B as ie}from"./Button-Bs2LlykX.js";import"./_commonjsHelpers-BosuxZz1.js";import"./browser-D9eauH0H.js";import"./index-edoyAQHv.js";import"./Confirm-DlxQ7D7t.js";import"./Menu-BfV33fk6.js";import"./useSlotProps-O828vP2f.js";import"./index-BMQyuaGg.js";import"./extendSxProp-2i1zAAUV.js";import"./useFormControl-CO6OogGI.js";import"./ButtonBase-B4crtf6-.js";import"./GlobalStyles-BW4QefxH.js";import"./useTheme-CLvhDb73.js";import"./useThemeWithoutDefault-BU2aPzft.js";import"./Stack-DUl2B3cg.js";import"./useThemeProps-DZ1rqyJn.js";import"./getThemeProps-BL5VHue0.js";import"./CircularProgress-CKHSwoEO.js";import"./index-D3ylJrlI.js";import"./toPropertyKey-PLuKRk1e.js";import"./MenuItem-BvZfPpYr.js";import"./ListItemText-7JFmWKqR.js";import"./Autocomplete-Byzw-jYA.js";import"./Select-DstqRMzc.js";import"./FormLabel-BgEYUhxt.js";import"./Close-mNv2SlFn.js";import"./Popper-1aVe17Xg.js";import"./usePreviousProps-eB1Ppz6I.js";import"./app-Bt98msSn.js";import"./index-BqRrtboY.js";import"./utc-BUuWioZ3.js";import"./ThemeProvider-BQTsL86O.js";import"./ListItemIcon-CVfiqn-C.js";import"./Checkbox-jThM1nDo.js";import"./SwitchBase-3IV-eDJc.js";import"./TextField-CXY6ukfK.js";import"./TableCell-gutrWIi-.js";import"./FormControlLabel-Do0ozMLQ.js";import"./axios-DPCeRp2O.js";import"./global-Cavf3q2D.js";import"./index-BDIa4gQt.js";import"./_baseIsEqual-DkReohVf.js";import"./InputAdornment-C1l6JSIr.js";var M={},re=J;Object.defineProperty(M,"__esModule",{value:!0});var P=M.default=void 0,oe=re(K()),se=e;P=M.default=(0,oe.default)((0,se.jsx)("path",{d:"M19 1H5c-1.1 0-1.99.9-1.99 2L3 15.93c0 .69.35 1.3.88 1.66L12 23l8.11-5.41c.53-.36.88-.97.88-1.66L21 3c0-1.1-.9-2-2-2m-9 15-5-5 1.41-1.41L10 13.17l7.59-7.59L19 7z"}),"Beenhere");const ae=({region_id:n,can:o,filter:h,parentCallback:j})=>{var T,k,L,A,N,B;const C=X(),[m,d]=s.useState(!1),[x,S]=s.useState(),[r,u]=s.useState(h);let g=(T=r==null?void 0:r.filter)==null?void 0:T.type;const[v,f]=W.useState(!1),w=t=>{l.Inertia.post(a("admin.items.removedpublication"),{id:t},{preserveState:!0,onSuccess:()=>{i.reload()}})},y=t=>{l.Inertia.post(a("admin.items.multiple.trash"),{ids:t},{preserveState:!0,onSuccess:()=>{p()}})},I=t=>{l.Inertia.post(a("admin.items.multiple.restore"),{ids:t},{preserveState:!0,onSuccess:()=>{p()}})},_=t=>{l.Inertia.delete(a("admin.items.multiple.destroy"),{data:{ids:t}})},p=()=>{let t="success";d(!1),j(t),u(void 0)};s.useEffect(()=>{n!==void 0&&m==!1&&d(!0)},[n,d]),s.useEffect(()=>{u(t=>({filter:{"collection.id":n}}))},[h,n]);const i=H({mode:"xhr",filter:r,xhrUrl:a("admin.getallitemsmodel"),search:x}),b=[{field:"id",headerName:"Id",renderCell:t=>e.jsx(F,{display:"flex",justifyContent:"space-between",children:t.id})},{field:"title",headerName:"Title",renderCell:t=>{var c;return e.jsxs(e.Fragment,{children:[t.row.is_site==3?e.jsx(ee,{title:"Already Copied",children:e.jsx(P,{sx:{fontSize:C.typography.fontSize}})}):e.jsx(e.Fragment,{}),e.jsx(R,{href:a("admin.items.edit",{id:t.row.id}).toString(),children:Y(t.row)||((c=t.row.contents[0])==null?void 0:c.title)||"- no title -"})]})},flex:2},G,E("created_at","Created at"),E("updated_at","Updated at"),{field:"type",headerName:"Type"},{field:"subtype",headerName:"Subtype"},{field:"Change Status",sortable:!1,renderCell:t=>e.jsx("div",{children:e.jsx($,{checked:t.row.is_site=="3",onChange:c=>{c.preventDefault(),w(t.row.id)}})}),flex:1}];s.useEffect(()=>{m||window.scrollTo(0,0)},[m]);const q=t=>{f(!0),l.Inertia.post(a("admin.items.addmainsite",{}),{ids:t,setTypes:g},{preserveState:!0,onSuccess:c=>{p(),f(!1)},onError:c=>{f(!1)}})};return e.jsx(e.Fragment,{children:m&&e.jsxs(Z,{open:!0,onClose:p,maxWidth:!1,children:[e.jsx(O,{title:"Subsite Items",isDialog:!0,filterOptions:[{label:"Publication",name:"publication.id",value:"19"},{label:"Missing translations",name:"missing_translations"},{label:"Missing workarea",name:"missing_workarea"},{label:"Hide unpublished",name:"status",value:"published"},{label:"Trashed items",name:"trashed",value:"only"},{label:"Only Subsite Items",name:"is_site",value:"2"}],filter:r,onSearch:S,onChangeFilter:u,children:e.jsx(D,{edge:"end",color:"inherit",onClick:p,"aria-label":"close",size:"large",children:e.jsx(Q,{})})}),e.jsx(F,{sx:{paddingTop:0,height:"100%",minHeight:"80vh",maxHeight:"unset",minWidth:"90vw",maxWidth:"unset",boxSizing:"border-box",overflowY:"auto",display:"flex",flexDirection:"column"},children:e.jsx(z,{columns:b,dataSource:i,multiSelectActions:{actions:((k=r==null?void 0:r.filter)==null?void 0:k.trashed)==="only"?[...(L=o==null?void 0:o.items)!=null&&L.restoreMany?[{identifier:"restore",label:"Restore",onAction:I}]:[],...(A=o==null?void 0:o.items)!=null&&A.forceDeleteMany?[{identifier:"destroy",label:"Delete permanently",onAction:_}]:[]]:(N=o==null?void 0:o.items)!=null&&N.deleteMany?[{identifier:"trash",label:"Move to Trash",onAction:y}]:[],mainsite:((B=r==null?void 0:r.filter)==null?void 0:B.trashed)!="only"?[{identifier:"Add",label:"Copy to MainSite",onAction:q,loader:v}]:[]}})})]},n)})},xt=({subsites:n,filter:o,sort:h,can:j})=>{const[C,m]=s.useState(),[d,x]=s.useState(o),[S,r]=s.useState(),u=H({mode:"inertia",paginatedData:n,search:C,filter:d,sort:h}),[g,v]=s.useState(""),f=i=>{v(i)};function w(i){l.Inertia.delete(a("admin.subsites.destroy",{id:i}),{preserveState:!0})}s.useEffect(()=>{g=="success"&&r("")},[g]);const y=i=>{r(i)},I=[{field:"id",headerName:"Id",align:"center",headerAlign:"center"},{headerName:"Subsite Name",field:"name",renderCell:i=>e.jsx(R,{href:a("admin.subsites.edit",{id:i.row.id}).toString(),children:i.row.name??"- no name -"}),flex:2},{headerName:"Status",field:"is_active",flex:.5},{headerName:"Aliase Name",field:"aliase_name",flex:1.5},{field:"Preview",headerName:"Preview",sortable:!1,renderCell:i=>e.jsx(D,{onClick:()=>window.open(`${window.location.protocol}//${i.row.aliase_name}.${window.location.hostname}`),children:e.jsx(te,{})}),flex:.5,align:"center"},{field:"Subsite Items",sortable:!1,renderCell:i=>e.jsx(ie,{size:"small",variant:"contained",color:"primary",onClick:b=>{v(""),y(i.row.region_id)},children:"View Items"},i.row.region_id),flex:1,align:"center"},{field:"Change Status",sortable:!1,renderCell:i=>e.jsx("div",{children:e.jsx($,{checked:i.row.is_active=="active",onChange:b=>{b.preventDefault(),w(i.row.id)}})}),flex:.5,align:"center"}],_=()=>{l.Inertia.get(a("admin.subsites.create"))};return s.useEffect(()=>{x(o)},[o]),e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Subsites",filterOptions:[{label:"Hide in-active",name:"is_active",value:"active"}],filter:d,onSearch:m,onChangeFilter:x,children:e.jsx(D,{onClick:_,children:e.jsx(U,{})})}),e.jsx(V,{children:e.jsx(z,{columns:I,dataSource:u,selectMode:"none"})}),S?e.jsx(ae,{region_id:S,can:j,parentCallback:f}):e.jsx(e.Fragment,{})]})};export{xt as default};
