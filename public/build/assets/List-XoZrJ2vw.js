import{r as s,R as c,j as e}from"./client-ZKQMN23D.js";import{d as l,I as V}from"./index-Cvft0mqj.js";import{d as $}from"./Add-CSI57y4_.js";import{e as G,f as v}from"./app-Bt98msSn.js";import{l as a}from"./index.m-DI45-rQC.js";import{u as J,L as K}from"./useDataSource-CV27kxAN.js";import{P as U}from"./PublishStatusIcon-CFRSoGcQ.js";import{L as W}from"./Listing-BOo8Gk8o.js";import{D as X}from"./DataCellCollectionTree-CJhNu20T.js";import{S as Y}from"./ShareRecord-CVq8AChO.js";import{A as Z}from"./AppBarHeader-Bu_GnhUD.js";import{C as tt}from"./ContentScroll-BWeVEx1a.js";import{f as et}from"./Content-CSTk_AN3.js";import{L as ot,m as D}from"./DataGridUtils-DqQ54bwL.js";import{I as u}from"./List-BgSNNkKU.js";import{B as it}from"./Box-CVOB97vC.js";import"./_commonjsHelpers-BosuxZz1.js";import"./browser-D9eauH0H.js";import"./index-edoyAQHv.js";import"./identifier-DHETMsl0.js";import"./Typography-BOH_kjYl.js";import"./ButtonBase-B4crtf6-.js";import"./useSlotProps-O828vP2f.js";import"./index-BMQyuaGg.js";import"./extendSxProp-2i1zAAUV.js";import"./Grow--1bk2Oiz.js";import"./useTheme-CLvhDb73.js";import"./useThemeWithoutDefault-BU2aPzft.js";import"./index-BqRrtboY.js";import"./dayjs.min-BIwLhz4I.js";import"./utc-BUuWioZ3.js";import"./ThemeProvider-BQTsL86O.js";import"./useThemeProps-DZ1rqyJn.js";import"./getThemeProps-BL5VHue0.js";import"./Close-mNv2SlFn.js";import"./ListItemIcon-CVfiqn-C.js";import"./ListItemText-7JFmWKqR.js";import"./Tooltip-CvPWsRqB.js";import"./Popper-1aVe17Xg.js";import"./Button-Bs2LlykX.js";import"./GlobalStyles-BW4QefxH.js";import"./axios-DPCeRp2O.js";import"./global-Cavf3q2D.js";import"./index-BDIa4gQt.js";import"./_baseIsEqual-DkReohVf.js";import"./Confirm-DlxQ7D7t.js";import"./Menu-BfV33fk6.js";import"./useFormControl-CO6OogGI.js";import"./Stack-DUl2B3cg.js";import"./CircularProgress-CKHSwoEO.js";import"./index-D3ylJrlI.js";import"./toPropertyKey-PLuKRk1e.js";import"./MenuItem-BvZfPpYr.js";import"./Autocomplete-Byzw-jYA.js";import"./Select-DstqRMzc.js";import"./FormLabel-BgEYUhxt.js";import"./usePreviousProps-eB1Ppz6I.js";import"./Checkbox-jThM1nDo.js";import"./SwitchBase-3IV-eDJc.js";import"./TextField-CXY6ukfK.js";import"./TableCell-gutrWIi-.js";import"./FormControlLabel-Do0ozMLQ.js";import"./Twitter-DyTnTSc8.js";import"./Dialog-CPjb0mTO.js";import"./DialogTitle-DqHD2Xkp.js";import"./Grid-BYUzo7jW.js";import"./RadioGroup-DVoAhqow.js";import"./FormGroup-BWakBykC.js";import"./InputAdornment-C1l6JSIr.js";const ye=({collections:n,child_types:m,filter:d,sort:R,can:o})=>{var y,b,S,C,w,I,L,A;const[i,f]=s.useState(d),[E,F]=s.useState(),M=J({mode:"inertia",paginatedData:n,search:E,filter:i,sort:R}),[k,h]=c.useState(!1);s.useEffect(()=>{n.data.forEach(({id:t,status:r})=>{})},[n]);const T=()=>{l.Inertia.get(a("admin.collections.create"))};s.useEffect(()=>{f(d)},[d]);const B=[{field:"id",renderCell:t=>e.jsxs(it,{display:"flex",justifyContent:"space-between",children:[t.id," ",e.jsx(X,{collection:t.row,onSelect:r=>l.Inertia.get(a("admin.collections.edit",{id:r.id}))})]}),align:"right"},{field:"Share Post",sortable:!1,hide:k,renderCell:t=>e.jsx("div",{children:t.row.status=="published"&&(t.row.type=="articles"||t.row.type=="dossier")?e.jsx(u,{onClick:r=>{r.stopPropagation(),q(t.row.id,t.row.contents.map(p=>p.lang).join(","))},children:e.jsx(v,{})}):e.jsx(u,{disabled:!0,children:e.jsx(v,{})})}),flex:1},{field:"title",renderCell:t=>e.jsxs(e.Fragment,{children:[m!=null&&m.includes(t.row.type)?e.jsx(e.Fragment,{children:"—  "}):e.jsx(e.Fragment,{}),e.jsxs(V,{href:a("admin.collections.edit",{id:t.row.id}).toString(),children:[e.jsx(U,{item:t.row})," ",et(t.row)??"- no title -"]})]}),flex:2},ot,D("created_at"),D("updated_at"),{field:"items_count",headerName:"Items",renderCell:t=>e.jsx(K,{toRoute:"admin.items.index",query:{filter:{"collection.id":t.row.id}},children:t.value}),align:"right"},{field:"type"},{field:"layout"}],x=[{label:"Missing translations",name:"missing_translations"},{label:"Empty collections",name:"items_count",value:"0"},{label:"Hide unpublished",name:"status",value:"published"},{label:"Trashed collections",name:"trashed",value:"only"}];(b=(y=i==null?void 0:i.filter)==null?void 0:y.type)!=null&&b.includes("dossier")&&x.push({label:"Show subdossiers",name:"type",value:"dossier,dossier_sub",disabledValue:"dossier"});const[g,P]=s.useState([]),[j,_]=c.useState(""),[H,O]=c.useState(""),q=(t,r)=>{const p=r.split(",");O(p),_(t),P({...g,type:"collection",id:t})},z=t=>{l.Inertia.post(a("admin.collections.multiple.trash"),{ids:t})},N=t=>{l.Inertia.post(a("admin.collections.multiple.restore"),{ids:t})},Q=t=>{l.Inertia.delete(a("admin.collections.multiple.destroy"),{data:{ids:t}})};return s.useEffect(()=>{var t;((t=i==null?void 0:i.filter)==null?void 0:t.trashed)==="only"?h(!0):h(!1)},[i]),e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:"Collections",filterOptions:x,filter:i,onSearch:F,onChangeFilter:f,children:e.jsx(u,{onClick:T,disabled:!((S=o==null?void 0:o.collections)!=null&&S.create)&&!((C=o==null?void 0:o.collections)!=null&&C.createLimited),size:"large",children:e.jsx($,{})})}),e.jsx(tt,{children:e.jsx(W,{columns:B,dataSource:M,multiSelectActions:{actions:((w=i==null?void 0:i.filter)==null?void 0:w.trashed)==="only"?[...(I=o==null?void 0:o.collections)!=null&&I.restoreMany?[{identifier:"restore",label:"Restore",onAction:N}]:[],...(L=o==null?void 0:o.collections)!=null&&L.forceDeleteMany?[{identifier:"destroy",label:"Delete permanently",onAction:Q}]:[]]:(A=o==null?void 0:o.collections)!=null&&A.deleteMany?[{identifier:"trash",label:"Move to Trash",onAction:z}]:[]}})}),j?e.jsx(Y,{RecordLang:H,Id:j,setArray:g,AvailableLang:G}):e.jsx(e.Fragment,{})]})};export{ye as default};
