import{c as C,j as e,r as s}from"./client-ZKQMN23D.js";import{a as w}from"./axios-CMJq23T0.js";import{d as p}from"./dayjs.min-BIwLhz4I.js";import{u as N}from"./utc-BUuWioZ3.js";import{Themed as M}from"./Themed-BvoZDduG.js";import{Map as F}from"./Map-D6a-smP6.js";import{SidebarItems as D}from"./SidebarItems-CuYVJ5W3.js";import{YearRangeSlider as Y}from"./YearRangeSlider-Cd8fDOxM.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-BDIa4gQt.js";import"./identifier-CVVhstXo.js";import"./ThemeProvider-DYHukqtx.js";import"./index-AoxikDaj.js";import"./Grow-1FiP9biG.js";import"./useSlotProps-DL7U-EaF.js";import"./extendSxProp-5tSxLnIE.js";import"./ua-parser-BZV2fO3c.js";import"./index-D3ylJrlI.js";import"./useMediaQuery-DtNN74dm.js";import"./Tooltip-B-18blil.js";import"./Popper-BKUAU8_E.js";import"./Slider-axkRW3N_.js";import"./index-BXImJBSP.js";p.extend(N);const $=({collection_id:d,lang:a,translations:t})=>{const[x,j]=s.useState({}),[h,c]=s.useState(),[n,y]=s.useState(2019),[m,b]=s.useState(new Date().getFullYear()),[f,_]=s.useState(!1),l=s.useMemo(()=>({collection:d,published_after:n?p().set("year",n).startOf("year").utc().format():void 0,published_before:m?p().set("year",m).endOf("year").utc().format():void 0}),[d,n,m]);s.useEffect(()=>{const r=new AbortController;if(l.collection)return w.get("/api/map/items_count",{params:{filter:l,lang:a},signal:r.signal}).then(o=>{if(o.data){const u={};Object.entries(o.data).forEach(([g,i])=>u[g]={...i,className:`activity_${i.items_count?i.items_count<=1?"low":i.items_count<=3?"medium":"high":"none"}`,annotationLabel:i.items_count?`${i.items_count} ${i.items_count===1?t.article:t.articles}`:""}),j(u)}}).catch(o=>{console.warn("load mapdata",o)}),()=>r.abort()},[l,a,t]);const v=s.useCallback(r=>{r||c(void 0),_(!!r)},[]),S=s.useCallback(r=>{r!=null&&r.items_count?c(r):c(void 0)},[]);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"map_container",children:[e.jsx(F,{mapData:x,onSelectCountry:S}),e.jsxs("div",{className:"map_year_range",children:[e.jsx("h3",{children:t.solidarity_across_borders_time_range}),e.jsx(Y,{min:2019,onChange:(r,o)=>{y(r),b(o||new Date().getFullYear())}}),e.jsxs("span",{children:[n," - ",m]})]}),e.jsx("button",{className:"map_sidebar_opener",onClick:()=>{_(!0),c(void 0)},children:"?"}),e.jsxs("div",{className:`map_sidebar ${f?"active":""}`,children:[e.jsx("button",{className:`map_sidebar_closer ${h?"close_country":"close_intro"}`,onClick:()=>{_(!1),c(void 0)},children:"тип"}),e.jsx(D,{initialContent:e.jsxs(e.Fragment,{children:[e.jsx("h3",{children:t.solidarity_across_borders_title}),e.jsx("p",{children:t.solidarity_across_borders_intro_text}),e.jsx("h4",{children:t.solidarity_across_borders_activity_title}),e.jsxs("dl",{className:"map_legend",children:[e.jsx("dt",{children:e.jsx("span",{className:"activity_high"})}),e.jsx("dd",{children:t.solidarity_across_borders_activity_high}),e.jsx("dt",{children:e.jsx("span",{className:"activity_medium"})}),e.jsx("dd",{children:t.solidarity_across_borders_activity_medium}),e.jsx("dt",{children:e.jsx("span",{className:"activity_low"})}),e.jsx("dd",{children:t.solidarity_across_borders_activity_low}),e.jsx("dt",{children:e.jsx("span",{className:"activity_none"})}),e.jsx("dd",{children:t.solidarity_across_borders_activity_none})]})]}),selectedCountry:h,filter:l,onChangeItemCount:v,lang:a})]})]})})},k=(d,a)=>{C(d).render(e.jsx(M,{children:e.jsx($,{...a})}))};window.renderSolidarityMap=k;
